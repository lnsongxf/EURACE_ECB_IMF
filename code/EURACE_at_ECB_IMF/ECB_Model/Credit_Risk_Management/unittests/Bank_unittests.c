#include <CUnit/Basic.h>
#include <gsl/gsl_rng.h>

#include "../../../header.h"
#include "../../../Bank_agent_header.h"
#include "../../../my_library_header.h"
//#include "../../../Statistical_Office/balance_sheet_operations.h"

/*
unittest_Bank_set_risk_weight_household_loans_1();
unittest_Bank_set_risk_weight_household_loans_2();
unittest_Bank_set_risk_weight_household_loans_3();
unittest_Bank_set_risk_weight_household_loans_4();
*/

/************Bank Role: Mortgage Market********************************/
/*
 * \fn: void unittest_()
 * \brief: Unit test for: .
 * Status: NOT Tested
 */
//void unittest_Bank_()
//{

	
    /************* At start of unit test, add one agent **************/
	//unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
	//FLAME_environment_variable_print_debug_mortgage = 1;
    
	/***** Messages: initialize message boards **********************************/
	//MB_Create(&b_mortgage_default, sizeof(m_mortgage_default));
	
	/***** Messages: pre-conditions **********************************/

    /***** Message: Adding message iterators ***************************************/
	//MB_Iterator_Create(b_mortgage_default, &i_mortgage_default);

	//HH_ID_MESSAGE
	/***** Messages: initialize message boards **********************************/
	//MB_Create(&b_mortgage_payment, sizeof(m_mortgage_payment));
	
	/***** Messages: pre-conditions **********************************/
        //add_mortgage_payment_message(int household_id, int bank_id, double principal, double interest)

    /***** Message: Adding message iterators ***************************************/
	//MB_Iterator_Create(b_mortgage_payment, &i_mortgage_payment);

    /***** Function evaluation ***************************************/
	//Bank_();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-3);
    //	CU_ASSERT_EQUAL(var, result);


    /***** Messages: Message post-conditions *****/
	//start a reading loop
	
    /************* At end of unit test, free the agent **************/
//	unittest_free_Bank_agent();
    /************* At end of unit tests, free all Messages **********/
//    free_messages();
//}

    
/************ Unit tests ********************************/
/*
 * \fn: void unittest_Bank_set_pd_lgd_yearly_household_loans()
 * \brief: Unit test for: testing the 75th percentile using GSL.
 * Status: NOT Tested
 */
void unittest_Bank_set_pd_lgd_yearly_household_loans()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
	int i, n;
    /***** Variables: Memory pre-conditions **************************/
	FLAME_environment_variable_print_debug_credit_risk_mngt = 1;

	/***** Messages: initialize message boards **********************************/
	//MB_Create(&b_mortgage_default, sizeof(m_mortgage_default));
	
	/***** Messages: pre-conditions **********************************/

    /***** Message: Adding message iterators ***************************************/
	//MB_Iterator_Create(b_mortgage_default, &i_mortgage_default);

	

	/***** Messages: initialize message boards **********************************/
	//MB_Create(&b_mortgage_payment, sizeof(m_mortgage_payment));
	
	/***** Messages: pre-conditions **********************************/
    //add_mortgage_payment_message(int household_id, int bank_id, double principal, double interest)

    /***** Message: Adding message iterators ***************************************/
	//MB_Iterator_Create(b_mortgage_payment, &i_mortgage_payment);

    /***** Function evaluation ***************************************/
	//Bank_();
    
	/* 75th percentile of array HH_LGD_CYCLE*/
	
	for (i=0; i<100; i++)
		add_double(&HH_LGD_CYCLE, random_unif_interval(1.0, 100.0));

	printf("\n\nSize: %d", HH_LGD_CYCLE.size);

	n = HH_LGD_CYCLE.size;
	
	double sorted_data[n];
	
	//Copy
	for (i=0; i<n; i++)
		sorted_data[i] = HH_LGD_CYCLE.array[i];
	
	printf("\n\nBefore sorting:\n sorted_data[i]");
	for (i=0; i<n; i++)
		printf(" %f", sorted_data[i]);
	
	gsl_sort(sorted_data, 1, n);
	

	printf("\n\nAfter sorting:\n sorted_data[i]");
	for (i=0; i<n; i++)
		printf(" %f", sorted_data[i]);


	//double f20 = gsl_stats_quantile_from_sorted_data(sorted_data, 1, n, 0.20);
	//double f30 = gsl_stats_quantile_from_sorted_data(sorted_data, 1, n, 0.30);
	//double f40 = gsl_stats_quantile_from_sorted_data(sorted_data, 1, n, 0.40);
	//double f50 = gsl_stats_quantile_from_sorted_data(sorted_data, 1, n, 0.50);
	//double f60 = gsl_stats_quantile_from_sorted_data(sorted_data, 1, n, 0.60);
	//double f70 = gsl_stats_quantile_from_sorted_data(sorted_data, 1, n, 0.70);
	
	//double f75 = gsl_stats_quantile_from_sorted_data(sorted_data, 1, n, 0.75);

	//int j = (int) 0.75*n;
	//double f75 = sorted_data[j];

	//Simple solution:
	double f20 = sorted_data[19];
	double f30 = sorted_data[29];
	double f40 = sorted_data[39];
	double f50 = sorted_data[49];
	double f60 = sorted_data[59];
	double f70 = sorted_data[69];
	double f75 = sorted_data[74];

	//minimum
	double min = gsl_stats_quantile_from_sorted_data(sorted_data, 1, n, 0.0);

	//maximum
	double max = gsl_stats_quantile_from_sorted_data(sorted_data, 1, n, 1.0);
	
	
	printf("\n\n\nMin = %f", min);
	printf("\nf20 = %f", f20);
	printf("\nf30 = %f", f30);
	printf("\nf40 = %f", f40);
	printf("\nf50 = %f", f50);
	printf("\nf60 = %f", f60);
	printf("\nf75 = %f", f75);
	printf("\nMax = %f\n", max);

	


    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-3);
    //	CU_ASSERT_EQUAL(var, result);


    /***** Messages: Message post-conditions *****/
	//start a reading loop
	
    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}
   


/*
 * \fn: void unittest_Bank_set_risk_weight_household_loans_1()
 * \brief: Unit test for: testing the lookup functionality from a pre-specified vector of length 37x37= 1369.
 * Status: NOT Tested
 */
void unittest_Bank_set_risk_weight_household_loans_1()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
	int i,n;
    /***** Variables: Memory pre-conditions **************************/
	FLAME_environment_variable_print_debug_credit_risk_mngt = 1;
    
    /*Open file: matrix.csv*/
/*
    FILE *file;
    char *filename;    

    filename = malloc(40*sizeof(char));
    filename[0]=0;
    strcpy(filename, "matrix.csv");
	file = fopen(filename,"r");

    n=1369;
	for (i=0; i<n; i++)
    	fscanf(file, "%g", &(LOOKUPTABLE_RISKWEIGHTS_MORTGAGES[i]));

    fclose(file);
    free(filename);
*/

	/* For real 37*37 */   
	/*
    double A[1369]={0.0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55,0.6,0.65,0.7,0.75,0.8,0.85,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1.0,0.01,0.0125330945693,0.0250661891387,0.037599283708,0.0501323782774,0.0626654728467,0.0751985674161,0.0877316619854,0.100264756555,0.112797851124,0.125330945693,0.18799641854,0.250661891387,0.313327364234,0.37599283708,0.438658309927,0.501323782774,0.56398925562,0.626654728467,0.689320201314,0.751985674161,0.814651147007,0.877316619854,0.939982092701,1.00264756555,1.06531303839,1.12797851124,1.14051160581,1.15304470038,1.16557779495,1.17811088952,1.19064398409,1.20317707866,1.21571017323,1.2282432678,1.24077636236,1.25330945693,0.02,0.0195411173933,0.0390822347865,0.0586233521798,0.0781644695731,0.0977055869664,0.11724670436,0.136787821753,0.156328939146,0.175870056539,0.195411173933,0.293116760899,0.390822347865,0.488527934832,0.586233521798,0.683939108765,0.781644695731,0.879350282697,0.977055869664,1.07476145663,1.1724670436,1.27017263056,1.36787821753,1.4655838045,1.56328939146,1.66099497843,1.75870056539,1.77824168279,1.79778280018,1.81732391757,1.83686503497,1.85640615236,1.87594726975,1.89548838715,1.91502950454,1.93457062193,1.95411173933,0.03,0.0248861439755,0.0497722879511,0.0746584319266,0.0995445759022,0.124430719878,0.149316863853,0.174203007829,0.199089151804,0.22397529578,0.248861439755,0.373292159633,0.497722879511,0.622153599389,0.746584319266,0.871015039144,0.995445759022,1.1198764789,1.24430719878,1.36873791866,1.49316863853,1.61759935841,1.74203007829,1.86646079817,1.99089151804,2.11532223792,2.2397529578,2.26463910177,2.28952524575,2.31441138973,2.3392975337,2.36418367768,2.38906982165,2.41395596563,2.4388421096,2.46372825358,2.48861439755,0.04,0.0292513050569,0.0585026101138,0.0877539151707,0.117005220228,0.146256525285,0.175507830341,0.204759135398,0.234010440455,0.263261745512,0.292513050569,0.438769575854,0.585026101138,0.731282626423,0.877539151707,1.02379567699,1.17005220228,1.31630872756,1.46256525285,1.60882177813,1.75507830341,1.9013348287,2.04759135398,2.19384787927,2.34010440455,2.48636092984,2.63261745512,2.66186876018,2.69112006524,2.72037137029,2.74962267535,2.77887398041,2.80812528546,2.83737659052,2.86662789558,2.89587920063,2.92513050569,0.05,0.0329382384921,0.0658764769842,0.0988147154763,0.131752953968,0.16469119246,0.197629430953,0.230567669445,0.263505907937,0.296444146429,0.329382384921,0.494073577381,0.658764769842,0.823455962302,0.988147154763,1.15283834722,1.31752953968,1.48222073214,1.6469119246,1.81160311707,1.97629430953,2.14098550199,2.30567669445,2.47036788691,2.63505907937,2.79975027183,2.96444146429,2.99737970278,3.03031794127,3.06325617977,3.09619441826,3.12913265675,3.16207089524,3.19500913373,3.22794737223,3.26088561072,3.29382384921,0.06,0.0361152946859,0.0722305893718,0.108345884058,0.144461178744,0.180576473429,0.216691768115,0.252807062801,0.288922357487,0.325037652173,0.361152946859,0.541729420288,0.722305893718,0.902882367147,1.08345884058,1.26403531401,1.44461178744,1.62518826087,1.80576473429,1.98634120772,2.16691768115,2.34749415458,2.52807062801,2.70864710144,2.88922357487,3.0698000483,3.25037652173,3.28649181642,3.3226071111,3.35872240579,3.39483770047,3.43095299516,3.46706828985,3.50318358453,3.53929887922,3.5754141739,3.61152946859,0.07,0.0388889373971,0.0777778747941,0.116666812191,0.155555749588,0.194444686985,0.233333624382,0.272222561779,0.311111499176,0.350000436573,0.388889373971,0.583334060956,0.777778747941,0.972223434926,1.16666812191,1.3611128089,1.55555749588,1.75000218287,1.94444686985,2.13889155684,2.33333624382,2.52778093081,2.72222561779,2.91667030478,3.11111499176,3.30555967875,3.50000436573,3.53889330313,3.57778224053,3.61667117793,3.65556011532,3.69444905272,3.73333799012,3.77222692751,3.81111586491,3.85000480231,3.88889373971,0.08,0.0413320470599,0.0826640941197,0.12399614118,0.165328188239,0.206660235299,0.247992282359,0.289324329419,0.330656376479,0.371988423539,0.413320470599,0.619980705898,0.826640941197,1.0333011765,1.2399614118,1.4466216471,1.65328188239,1.85994211769,2.06660235299,2.27326258829,2.47992282359,2.68658305889,2.89324329419,3.09990352949,3.30656376479,3.51322400009,3.71988423539,3.76121628245,3.80254832951,3.84388037657,3.88521242363,3.92654447069,3.96787651775,4.00920856481,4.05054061187,4.09187265893,4.13320470599,0.09,0.043497344779,0.086994689558,0.130492034337,0.173989379116,0.217486723895,0.260984068674,0.304481413453,0.347978758232,0.391476103011,0.43497344779,0.652460171685,0.86994689558,1.08743361948,1.30492034337,1.52240706727,1.73989379116,1.95738051506,2.17486723895,2.39235396285,2.60984068674,2.82732741064,3.04481413453,3.26230085843,3.47978758232,3.69727430622,3.91476103011,3.95825837489,4.00175571967,4.04525306445,4.08875040923,4.13224775401,4.17574509879,4.21924244357,4.26273978834,4.30623713312,4.3497344779,0.1,0.0454245559224,0.0908491118448,0.136273667767,0.18169822369,0.227122779612,0.272547335534,0.317971891457,0.363396447379,0.408821003302,0.454245559224,0.681368338836,0.908491118448,1.13561389806,1.36273667767,1.58985945728,1.8169822369,2.04410501651,2.27122779612,2.49835057573,2.72547335534,2.95259613496,3.17971891457,3.40684169418,3.63396447379,3.8610872534,4.08821003302,4.13363458894,4.17905914486,4.22448370078,4.26990825671,4.31533281263,4.36075736855,4.40618192447,4.4516064804,4.49703103632,4.54245559224,0.15,0.0523827886155,0.104765577231,0.157148365846,0.209531154462,0.261913943077,0.314296731693,0.366679520308,0.419062308924,0.471445097539,0.523827886155,0.785741829232,1.04765577231,1.30956971539,1.57148365846,1.83339760154,2.09531154462,2.3572254877,2.61913943077,2.88105337385,3.14296731693,3.40488126001,3.66679520308,3.92870914616,4.19062308924,4.45253703232,4.71445097539,4.76683376401,4.81921655263,4.87159934124,4.92398212986,4.97636491847,5.02874770709,5.0811304957,5.13351328432,5.18589607293,5.23827886155,0.2,0.0562486277589,0.112497255518,0.168745883277,0.224994511035,0.281243138794,0.337491766553,0.393740394312,0.449989022071,0.50623764983,0.562486277589,0.843729416383,1.12497255518,1.40621569397,1.68745883277,1.96870197156,2.24994511035,2.53118824915,2.81243138794,3.09367452674,3.37491766553,3.65616080433,3.93740394312,4.21864708191,4.49989022071,4.7811333595,5.0623764983,5.11862512606,5.17487375382,5.23112238157,5.28737100933,5.34361963709,5.39986826485,5.45611689261,5.51236552037,5.56861414813,5.62486277589,0.25,0.058062118283,0.116124236566,0.174186354849,0.232248473132,0.290310591415,0.348372709698,0.406434827981,0.464496946264,0.522559064547,0.58062118283,0.870931774245,1.16124236566,1.45155295707,1.74186354849,2.0321741399,2.32248473132,2.61279532273,2.90310591415,3.19341650556,3.48372709698,3.77403768839,4.06434827981,4.35465887122,4.64496946264,4.93528005405,5.22559064547,5.28365276375,5.34171488203,5.39977700032,5.4578391186,5.51590123688,5.57396335517,5.63202547345,5.69008759173,5.74814971002,5.8062118283,0.3,0.0583888490277,0.116777698055,0.175166547083,0.233555396111,0.291944245138,0.350333094166,0.408721943194,0.467110792221,0.525499641249,0.583888490277,0.875832735415,1.16777698055,1.45972122569,1.75166547083,2.04360971597,2.33555396111,2.62749820624,2.91944245138,3.21138669652,3.50333094166,3.7952751868,4.08721943194,4.37916367707,4.67110792221,4.96305216735,5.25499641249,5.31338526152,5.37177411054,5.43016295957,5.4885518086,5.54694065763,5.60532950666,5.66371835568,5.72210720471,5.78049605374,5.83888490277,0.35,0.0575786904166,0.115157380833,0.17273607125,0.230314761666,0.287893452083,0.3454721425,0.403050832916,0.460629523333,0.51820821375,0.575786904166,0.863680356249,1.15157380833,1.43946726042,1.7273607125,2.01525416458,2.30314761666,2.59104106875,2.87893452083,3.16682797291,3.454721425,3.74261487708,4.03050832916,4.31840178125,4.60629523333,4.89418868541,5.1820821375,5.23966082791,5.29723951833,5.35481820875,5.41239689916,5.46997558958,5.52755427999,5.58513297041,5.64271166083,5.70029035124,5.75786904166,0.4,0.0558665055766,0.111733011153,0.16759951673,0.223466022306,0.279332527883,0.335199033459,0.391065539036,0.446932044613,0.502798550189,0.558665055766,0.837997583649,1.11733011153,1.39666263941,1.6759951673,1.95532769518,2.23466022306,2.51399275095,2.79332527883,3.07265780671,3.35199033459,3.63132286248,3.91065539036,4.18998791824,4.46932044613,4.74865297401,5.02798550189,5.08385200747,5.13971851305,5.19558501862,5.2514515242,5.30731802978,5.36318453535,5.41905104093,5.4749175465,5.53078405208,5.58665055766,0.45,0.0534191872353,0.106838374471,0.160257561706,0.213676748941,0.267095936176,0.320515123412,0.373934310647,0.427353497882,0.480772685117,0.534191872353,0.801287808529,1.06838374471,1.33547968088,1.60257561706,1.86967155323,2.13676748941,2.40386342559,2.67095936176,2.93805529794,3.20515123412,3.47224717029,3.73934310647,4.00643904264,4.27353497882,4.540630915,4.80772685117,4.86114603841,4.91456522564,4.96798441288,5.02140360011,5.07482278735,5.12824197459,5.18166116182,5.23508034906,5.28849953629,5.34191872353,0.5,0.0503604179309,0.100720835862,0.151081253793,0.201441671724,0.251802089655,0.302162507586,0.352522925517,0.402883343448,0.453243761378,0.503604179309,0.755406268964,1.00720835862,1.25901044827,1.51081253793,1.76261462758,2.01441671724,2.26621880689,2.51802089655,2.7698229862,3.02162507586,3.27342716551,3.52522925517,3.77703134482,4.02883343448,4.28063552413,4.53243761378,4.58279803172,4.63315844965,4.68351886758,4.73387928551,4.78423970344,4.83460012137,4.8849605393,4.93532095723,4.98568137516,5.03604179309,0.55,0.0467848656196,0.0935697312392,0.140354596859,0.187139462478,0.233924328098,0.280709193718,0.327494059337,0.374278924957,0.421063790576,0.467848656196,0.701772984294,0.935697312392,1.16962164049,1.40354596859,1.63747029669,1.87139462478,2.10531895288,2.33924328098,2.57316760908,2.80709193718,3.04101626527,3.27494059337,3.50886492147,3.74278924957,3.97671357767,4.21063790576,4.25742277138,4.304207637,4.35099250262,4.39777736824,4.44456223386,4.49134709948,4.5381319651,4.58491683072,4.63170169634,4.67848656196,0.6,0.0427668609666,0.0855337219331,0.1283005829,0.171067443866,0.213834304833,0.256601165799,0.299368026766,0.342134887733,0.384901748699,0.427668609666,0.641502914499,0.855337219331,1.06917152416,1.283005829,1.49684013383,1.71067443866,1.9245087435,2.13834304833,2.35217735316,2.56601165799,2.77984596283,2.99368026766,3.20751457249,3.42134887733,3.63518318216,3.84901748699,3.89178434796,3.93455120892,3.97731806989,4.02008493086,4.06285179182,4.10561865279,4.14838551376,4.19115237472,4.23391923569,4.27668609666,0.65,0.0383659698728,0.0767319397457,0.115097909619,0.153463879491,0.191829849364,0.230195819237,0.26856178911,0.306927758983,0.345293728856,0.383659698728,0.575489548093,0.767319397457,0.959149246821,1.15097909619,1.34280894555,1.53463879491,1.72646864428,1.91829849364,2.11012834301,2.30195819237,2.49378804174,2.6856178911,2.87744774046,3.06927758983,3.26110743919,3.45293728856,3.49130325843,3.5296692283,3.56803519817,3.60640116805,3.64476713792,3.68313310779,3.72149907767,3.75986504754,3.79823101741,3.83659698728,0.7,0.0336307094752,0.0672614189503,0.100892128425,0.134522837901,0.168153547376,0.201784256851,0.235414966326,0.269045675801,0.302676385276,0.336307094752,0.504460642127,0.672614189503,0.840767736879,1.00892128425,1.17707483163,1.34522837901,1.51338192638,1.68153547376,1.84968902113,2.01784256851,2.18599611589,2.35414966326,2.52230321064,2.69045675801,2.85861030539,3.02676385276,3.06039456224,3.09402527172,3.12765598119,3.16128669067,3.19491740014,3.22854810962,3.26217881909,3.29580952857,3.32944023804,3.36307094752,0.75,0.0286010899999,0.0572021799999,0.0858032699998,0.11440436,0.14300545,0.17160654,0.20020763,0.228808719999,0.257409809999,0.286010899999,0.429016349999,0.572021799999,0.715027249998,0.858032699998,1.00103815,1.1440436,1.28704905,1.4300545,1.57305995,1.7160654,1.85907085,2.0020763,2.14508175,2.28808719999,2.43109264999,2.57409809999,2.60269918999,2.63130027999,2.65990136999,2.68850245999,2.71710354999,2.74570463999,2.77430572999,2.80290681999,2.83150790999,2.86010899999,0.8,0.0233103624248,0.0466207248496,0.0699310872744,0.0932414496992,0.116551812124,0.139862174549,0.163172536974,0.186482899398,0.209793261823,0.233103624248,0.349655436372,0.466207248496,0.58275906062,0.699310872744,0.815862684868,0.932414496992,1.04896630912,1.16551812124,1.28206993336,1.39862174549,1.51517355761,1.63172536974,1.74827718186,1.86482899398,1.98138080611,2.09793261823,2.12124298066,2.14455334308,2.16786370551,2.19117406793,2.21448443036,2.23779479278,2.2611051552,2.28441551763,2.30772588005,2.33103624248,0.85,0.017786158533,0.035572317066,0.0533584755989,0.0711446341319,0.0889307926649,0.106716951198,0.124503109731,0.142289268264,0.160075426797,0.17786158533,0.266792377995,0.35572317066,0.444653963324,0.533584755989,0.622515548654,0.711446341319,0.800377133984,0.889307926649,0.978238719314,1.06716951198,1.15610030464,1.24503109731,1.33396188997,1.42289268264,1.5118234753,1.60075426797,1.6185404265,1.63632658503,1.65411274357,1.6718989021,1.68968506063,1.70747121917,1.7252573777,1.74304353623,1.76082969476,1.7786158533,0.9,0.0120510036459,0.0241020072918,0.0361530109376,0.0482040145835,0.0602550182294,0.0723060218753,0.0843570255212,0.096408029167,0.108459032813,0.120510036459,0.180765054688,0.241020072918,0.301275091147,0.361530109376,0.421785127606,0.482040145835,0.542295164065,0.602550182294,0.662805200523,0.723060218753,0.783315236982,0.843570255212,0.903825273441,0.96408029167,1.0243353099,1.08459032813,1.09664133178,1.10869233542,1.12074333907,1.13279434271,1.14484534636,1.15689635,1.16894735365,1.1809983573,1.19304936094,1.20510036459,0.91,0.0108802602446,0.0217605204892,0.0326407807339,0.0435210409785,0.0544013012231,0.0652815614677,0.0761618217124,0.087042081957,0.0979223422016,0.108802602446,0.163203903669,0.217605204892,0.272006506116,0.326407807339,0.380809108562,0.435210409785,0.489611711008,0.544013012231,0.598414313454,0.652815614677,0.707216915901,0.761618217124,0.816019518347,0.87042081957,0.924822120793,0.979223422016,0.990103682261,1.00098394251,1.01186420275,1.02274446299,1.03362472324,1.04450498348,1.05538524373,1.06626550397,1.07714576422,1.08802602446,0.92,0.00970187693866,0.0194037538773,0.029105630816,0.0388075077546,0.0485093846933,0.0582112616319,0.0679131385706,0.0776150155093,0.0873168924479,0.0970187693866,0.14552815408,0.194037538773,0.242546923466,0.29105630816,0.339565692853,0.388075077546,0.43658446224,0.485093846933,0.533603231626,0.582112616319,0.630622001013,0.679131385706,0.727640770399,0.776150155093,0.824659539786,0.873168924479,0.882870801418,0.892572678356,0.902274555295,0.911976432234,0.921678309172,0.931380186111,0.94108206305,0.950783939988,0.960485816927,0.970187693866,0.93,0.00851593664479,0.0170318732896,0.0255478099344,0.0340637465791,0.0425796832239,0.0510956198687,0.0596115565135,0.0681274931583,0.0766434298031,0.0851593664479,0.127739049672,0.170318732896,0.21289841612,0.255478099344,0.298057782568,0.340637465791,0.383217149015,0.425796832239,0.468376515463,0.510956198687,0.553535881911,0.596115565135,0.638695248359,0.681274931583,0.723854614807,0.766434298031,0.774950234676,0.78346617132,0.791982107965,0.80049804461,0.809013981255,0.8175299179,0.826045854544,0.834561791189,0.843077727834,0.851593664479,0.94,0.0073225002945,0.014645000589,0.0219675008835,0.029290001178,0.0366125014725,0.043935001767,0.0512575020615,0.058580002356,0.0659025026505,0.073225002945,0.109837504417,0.14645000589,0.183062507362,0.219675008835,0.256287510307,0.29290001178,0.329512513252,0.366125014725,0.402737516197,0.43935001767,0.475962519142,0.512575020615,0.549187522087,0.58580002356,0.622412525032,0.659025026505,0.666347526799,0.673670027094,0.680992527388,0.688315027683,0.695637527977,0.702960028272,0.710282528566,0.717605028861,0.724927529155,0.73225002945,0.95,0.00612159925153,0.0122431985031,0.0183647977546,0.0244863970061,0.0306079962577,0.0367295955092,0.0428511947607,0.0489727940123,0.0550943932638,0.0612159925153,0.091823988773,0.122431985031,0.153039981288,0.183647977546,0.214255973804,0.244863970061,0.275471966319,0.306079962577,0.336687958834,0.367295955092,0.39790395135,0.428511947607,0.459119943865,0.489727940123,0.52033593638,0.550943932638,0.55706553189,0.563187131141,0.569308730393,0.575430329644,0.581551928896,0.587673528147,0.593795127399,0.59991672665,0.606038325902,0.612159925153,0.96,0.00491322232215,0.0098264446443,0.0147396669665,0.0196528892886,0.0245661116108,0.0294793339329,0.0343925562551,0.0393057785772,0.0442190008994,0.0491322232215,0.0736983348323,0.098264446443,0.122830558054,0.147396669665,0.171962781275,0.196528892886,0.221095004497,0.245661116108,0.270227227718,0.294793339329,0.31935945094,0.343925562551,0.368491674161,0.393057785772,0.417623897383,0.442190008994,0.447103231316,0.452016453638,0.45692967596,0.461842898282,0.466756120604,0.471669342926,0.476582565249,0.481495787571,0.486409009893,0.491322232215,0.97,0.00369729133689,0.00739458267378,0.0110918740107,0.0147891653476,0.0184864566844,0.0221837480213,0.0258810393582,0.0295783306951,0.033275622032,0.0369729133689,0.0554593700533,0.0739458267378,0.0924322834222,0.110918740107,0.129405196791,0.147891653476,0.16637811016,0.184864566844,0.203351023529,0.221837480213,0.240323936898,0.258810393582,0.277296850267,0.295783306951,0.314269763635,0.33275622032,0.336453511657,0.340150802994,0.343848094331,0.347545385667,0.351242677004,0.354939968341,0.358637259678,0.362334551015,0.366031842352,0.369729133689,0.98,0.00247360822724,0.00494721645447,0.00742082468171,0.00989443290895,0.0123680411362,0.0148416493634,0.0173152575907,0.0197888658179,0.0222624740451,0.0247360822724,0.0371041234085,0.0494721645447,0.0618402056809,0.0742082468171,0.0865762879533,0.0989443290895,0.111312370226,0.123680411362,0.136048452498,0.148416493634,0.16078453477,0.173152575907,0.185520617043,0.197888658179,0.210256699315,0.222624740451,0.225098348679,0.227571956906,0.230045565133,0.23251917336,0.234992781587,0.237466389815,0.239939998042,0.242413606269,0.244887214496,0.247360822724,0.99,0.00124170768937,0.00248341537874,0.00372512306812,0.00496683075749,0.00620853844686,0.00745024613623,0.0086919538256,0.00993366151498,0.0111753692043,0.0124170768937,0.0186256153406,0.0248341537874,0.0310426922343,0.0372512306812,0.043459769128,0.0496683075749,0.0558768460217,0.0620853844686,0.0682939229155,0.0745024613623,0.0807109998092,0.086919538256,0.0931280767029,0.0993366151498,0.105545153597,0.111753692043,0.112995399733,0.114237107422,0.115478815112,0.116720522801,0.11796223049,0.11920393818,0.120445645869,0.121687353558,0.122929061248,0.124170768937,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0};
	copy_double_array(&A, &LOOKUPTABLE_RISKWEIGHTS_MORTGAGES);
	*/

	double A[25]={
	0.0 , 0.01, 0.02, 0.03, 0.04,
	0.01, 0.11, 0.12, 0.13, 0.14,
	0.02, 0.21, 0.22, 0.23, 0.24,
	0.03, 0.31, 0.32, 0.33, 0.34,
	0.04, 0.41, 0.42, 0.43, 0.44};

	for (i=0;i<25;i++)
		add_double(&LOOKUPTABLE_RISKWEIGHTS_MORTGAGES, A[i]);

    BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.0;

    //TEST 1: Search for item: A[1][2]= 0.12
    /*
    HH_PD_PL_YEAR  = 0.001;  //exceeds 0.0, but not 0.01 -> stop on i=1
    HH_PD_PL_REG = HH_PD_PL_YEAR;
    HH_LGD_PL_REG = 0.015; //exceeds 0.01, but not 0.02 -> stop on j=2
	*/

    //TEST 2: Search for item: A[1][1]= 0.0
    HH_PD_PL_YEAR  = 0.0;  //exceeds 0.0 due to +epsilon in code (!), but not 0.01 -> stop on i=1
    HH_PD_PL_REG = HH_PD_PL_YEAR;
    HH_LGD_PL_REG = 0.0; //exceeds 0.0 due to +epsilon in code (!), but not 0.01 -> stop on j=1

    /***** Function evaluation ***************************************/
	Bank_set_risk_weight_household_loans();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-3);
    //	CU_ASSERT_EQUAL(var, result);
	printf("\n BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = %.2f", BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL);

/*
	Results:
	pd=1.000 lgd=1.000 x=0.505 a=-855825799.000 b=0.014 c=1.496
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0

	pd=0.990 lgd=0.990 x=0.525 a=-1251637437.000 b=0.014 c=1.496
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.1241707689
*/
	CU_ASSERT_DOUBLE_EQUAL(BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL, 0.11, 1e-3);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}

/*
 * \fn: void unittest_Bank_set_risk_weight_household_loans_2()
 * \brief: Unit test for: lookup of Basel risk-weight for a specific (PD,LGD)-tuple.
 * Status: NOT Tested
 */
void unittest_Bank_set_risk_weight_household_loans_2()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
	FLAME_environment_variable_print_debug_credit_risk_mngt = 1;
    
    BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.0;
    HH_PD_PL_YEAR  = 0.99;
    HH_PD_PL_REG = HH_PD_PL_YEAR;
    HH_LGD_PL_REG = 0.01;

    /***** Function evaluation ***************************************/
	Bank_set_risk_weight_household_loans();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-3);
    //	CU_ASSERT_EQUAL(var, result);
	printf("\n BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = %.2f", BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL);

/*
	Results:
	pd=1.000 lgd=0.000 x=1.505 a=708913744.000 b=0.014 c=1.496
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.00

	pd=0.990 lgd=0.010 x=1.495 a=-786062893.000 b=0.014 c=1.496
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.0012417077
*/
	CU_ASSERT_DOUBLE_EQUAL(BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL, 0.0012417077, 1e-3);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}

/*
 * \fn: void unittest_Bank_set_risk_weight_household_loans_3()
 * \brief: Unit test for: lookup of Basel risk-weight for a specific (PD,LGD)-tuple.
 * Status: NOT Tested
 */
void unittest_Bank_set_risk_weight_household_loans_3()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
	FLAME_environment_variable_print_debug_credit_risk_mngt = 1;
    
    BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.0;
    HH_PD_PL_YEAR  = 0.01;
    HH_PD_PL_REG = HH_PD_PL_YEAR;
    HH_LGD_PL_REG = 0.99;

    /***** Function evaluation ***************************************/
	Bank_set_risk_weight_household_loans();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-3);
    //	CU_ASSERT_EQUAL(var, result);
	printf("\n BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = %.2f", BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL);

/*
	Results:
	pd=0.000 lgd=1.000 x=1.505 a=708913744.000 b=inf c=-nan
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 

	pd=0.010 lgd=0.990 x=1.495 a=-786062893.000 b=0.137 c=1.457
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 1.2407763624
*/
	CU_ASSERT_DOUBLE_EQUAL(BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL, 1.2407763624, 1e-3);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}

/*
 * \fn: void unittest_Bank_set_risk_weight_household_loans_4()
 * \brief: Unit test for: lookup of Basel risk-weight for a specific (PD,LGD)-tuple.
 * Status: NOT Tested
 */
void unittest_Bank_set_risk_weight_household_loans_4()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
	FLAME_environment_variable_print_debug_credit_risk_mngt = 1;
    
    BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.0;
    HH_PD_PL_YEAR  = 0.01;
    HH_PD_PL_REG = HH_PD_PL_YEAR;
    HH_LGD_PL_REG = 0.01;

    /***** Function evaluation ***************************************/
	Bank_set_risk_weight_household_loans();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-3);
    //	CU_ASSERT_EQUAL(var, result);
	printf("\n BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = %.2f", BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL);

/*
	Results:
	pd=0.000 lgd=0.000 x=1.505 a=708913744.000 b=inf c=-nan
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 

	pd=0.010 lgd=0.010 x=1.505 a=-1634687713.000 b=0.137 c=1.457
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.0125330946
*/
	CU_ASSERT_DOUBLE_EQUAL(BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL, 0.0125330946, 1e-3);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}


/*
 * \fn: void unittest_Bank_set_risk_weight_household_loans_3()
 * \brief: Unit test for: lookup of Basel risk-weight for a specific (PD,LGD)-tuple.
 * Status: NOT Tested
 */
void unittest_Bank_set_risk_weight_household_loans_5()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
	FLAME_environment_variable_print_debug_credit_risk_mngt = 1;
    
    BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.0;
    HH_PD_PL_YEAR  = 0.0;
    HH_PD_PL_REG = HH_PD_PL_YEAR;
    HH_LGD_PL_REG = 0.99;

    /***** Function evaluation ***************************************/
	Bank_set_risk_weight_household_loans();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-3);
    //	CU_ASSERT_EQUAL(var, result);
	printf("\n BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = %.2f", BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL);

/*
	Results:
	pd=0.000 lgd=1.000 x=1.505 a=708913744.000 b=inf c=-nan
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 

	pd=0.010 lgd=0.990 x=1.495 a=-786062893.000 b=0.137 c=1.457
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 1.2407763624
*/
	CU_ASSERT_DOUBLE_EQUAL(BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL, 0.000000, 1e-3);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}

/*
 * \fn: void unittest_Bank_set_risk_weight_household_loans_4()
 * \brief: Unit test for: lookup of Basel risk-weight for a specific (PD,LGD)-tuple.
 * Status: NOT Tested
 */
void unittest_Bank_set_risk_weight_household_loans_6()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
	FLAME_environment_variable_print_debug_credit_risk_mngt = 1;
    
    BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.0;
    HH_PD_PL_YEAR  = 0.01;
    HH_PD_PL_REG = HH_PD_PL_YEAR;
    HH_LGD_PL_REG = 0.0;

    /***** Function evaluation ***************************************/
	Bank_set_risk_weight_household_loans();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-3);
    //	CU_ASSERT_EQUAL(var, result);
	printf("\n BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = %.2f", BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL);

/*
	Results:
	pd=0.000 lgd=0.000 x=1.505 a=708913744.000 b=inf c=-nan
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 

	pd=0.010 lgd=0.010 x=1.505 a=-1634687713.000 b=0.137 c=1.457
	BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL = 0.0125330946
*/
	CU_ASSERT_DOUBLE_EQUAL(BASEL_RISK_WEIGHT_MORTGAGE_LOANS_PL, 0.000000, 1e-3);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}


/*
 * \fn: void unittest_Bank_update_IRB_shortfall_firm_loans_1()
 * \brief: Unit test for: 
 * Status: PASS 26.10.17
 */
void unittest_Bank_update_IRB_shortfall_firm_loans_1()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
    EQUITY = 97.50;
    CAPITAL_ADJ_PL_FIRM_LOANS = 0.0;

    FIRM_EL_PL_YEAR = 2.5;
    FIRM_EL_PL_REG  = 7.3;
	REA_FIRM_LOANS  = 456.03;

	printf("\n\nFixture 1:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_FIRM_LOANS = %.2f\n FIRM_EL_PL_YEAR = %.2f\n FIRM_EL_PL_REG = %.2f\n REA_FIRM_LOANS = %.2f\n", 
    EQUITY,
    CAPITAL_ADJ_PL_FIRM_LOANS,
    FIRM_EL_PL_YEAR,
    FIRM_EL_PL_REG,
	REA_FIRM_LOANS);

    /***** Function evaluation ***************************************/
	Bank_update_IRB_shortfall_firm_loans();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-2);
    //	CU_ASSERT_EQUAL(var, result);
	printf("\n\nResult:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_FIRM_LOANS = %.2f", 
    EQUITY,
    CAPITAL_ADJ_PL_FIRM_LOANS);

    CU_ASSERT_DOUBLE_EQUAL(EQUITY, 92.70, 1e-2);
    CU_ASSERT_DOUBLE_EQUAL(CAPITAL_ADJ_PL_FIRM_LOANS, 4.80, 1e-2);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}

/*
 * \fn: void unittest_Bank_update_IRB_shortfall_firm_loans_2()
 * \brief: Unit test for: 
 * Status: PASS 26.10.17
 */
void unittest_Bank_update_IRB_shortfall_firm_loans_2()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
    EQUITY = 84.50;
    CAPITAL_ADJ_PL_FIRM_LOANS = 0.0;
    CAPITAL_ADJ_PL_FIRM_LOANS = 0.0;

    FIRM_EL_PL_YEAR = 15.5;
    FIRM_EL_PL_REG  = 10.9;
	REA_FIRM_LOANS  = 491.04;

	printf("\n\nFixture 2:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_FIRM_LOANS = %.2f\n FIRM_EL_PL_YEAR = %.2f\n FIRM_EL_PL_REG = %.2f\n REA_FIRM_LOANS = %.2f", 
    EQUITY,
    CAPITAL_ADJ_PL_FIRM_LOANS,
    FIRM_EL_PL_YEAR,
    FIRM_EL_PL_REG,
	REA_FIRM_LOANS);

    /***** Function evaluation ***************************************/
	Bank_update_IRB_shortfall_firm_loans();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-2);
    //	CU_ASSERT_EQUAL(var, result);
	printf("\n\nResult:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_FIRM_LOANS = %.2f", 
    EQUITY,
    CAPITAL_ADJ_PL_FIRM_LOANS);

    CU_ASSERT_DOUBLE_EQUAL(EQUITY, 87.45, 1e-2);
    CU_ASSERT_DOUBLE_EQUAL(CAPITAL_ADJ_PL_FIRM_LOANS, -2.95, 1e-2);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}

/*
 * \fn: void unittest_Bank_update_IRB_shortfall_firm_loans_3()
 * \brief: Unit test for: 
 * Status: PASS 26.10.17
 */
void unittest_Bank_update_IRB_shortfall_firm_loans_3()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
    EQUITY = 92.70;
    CAPITAL_ADJ_PL_FIRM_LOANS = 4.80;
    CAPITAL_ADJ_PL_FIRM_LOANS = 0.0;

    FIRM_EL_PL_YEAR = 15.5;
    FIRM_EL_PL_REG  = 10.9;
	REA_FIRM_LOANS  = 491.04;

	printf("\n\nFixture 2:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_FIRM_LOANS = %.2f\n FIRM_EL_PL_YEAR = %.2f\n FIRM_EL_PL_REG = %.2f\n REA_FIRM_LOANS = %.2f", 
    EQUITY,
    CAPITAL_ADJ_PL_FIRM_LOANS,
    FIRM_EL_PL_YEAR,
    FIRM_EL_PL_REG,
	REA_FIRM_LOANS);

    /***** Function evaluation ***************************************/
	Bank_update_IRB_shortfall_firm_loans();
    
    /***** Variables: Memory post-conditions *****/
	
	printf("\n\nResult:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_FIRM_LOANS = %.2f", 
    EQUITY,
    CAPITAL_ADJ_PL_FIRM_LOANS);

    CU_ASSERT_DOUBLE_EQUAL(EQUITY, 87.45, 1e-2);
    CU_ASSERT_DOUBLE_EQUAL(CAPITAL_ADJ_PL_FIRM_LOANS, -2.95, 1e-2);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}

/*
 * \fn: void unittest_Bank_update_IRB_shortfall_mortgage_loans_1()
 * \brief: Unit test for: 
 * Status: PASS 26.10.17
 */
void unittest_Bank_update_IRB_shortfall_mortgage_loans_1()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
    EQUITY = 97.50;
    CAPITAL_ADJ_PL_MORTGAGE_LOANS = 0.0;
    CAPITAL_ADJ_NPL_MORTGAGE_LOANS = 0.0;

    HH_EL_PL_YEAR = 2.5;
    HH_EL_PL_REG  = 7.3;
	REA_MORTGAGE_LOANS  = 456.03;

	printf("\n\nFixture 1:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_MORTGAGE_LOANS = %.2f\n HH_EL_PL_YEAR = %.2f\n HH_EL_PL_REG = %.2f\n REA_MORTGAGE_LOANS = %.2f\n", 
    EQUITY,
    CAPITAL_ADJ_PL_MORTGAGE_LOANS,
    HH_EL_PL_YEAR,
    HH_EL_PL_REG,
	REA_MORTGAGE_LOANS);

    /***** Function evaluation ***************************************/
	Bank_update_IRB_shortfall_mortgage_loans();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-2);
    //	CU_ASSERT_EQUAL(var, result);
	printf("\n\nResult:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_MORTGAGE_LOANS = %.2f\n CAPITAL_ADJ_NPL_MORTGAGE_LOANS = %.2f", 
    EQUITY,
    CAPITAL_ADJ_PL_MORTGAGE_LOANS,
    CAPITAL_ADJ_PL_MORTGAGE_LOANS);

    CU_ASSERT_DOUBLE_EQUAL(EQUITY, 92.70, 1e-2);
    CU_ASSERT_DOUBLE_EQUAL(CAPITAL_ADJ_PL_MORTGAGE_LOANS, 4.80, 1e-2);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}

/*
 * \fn: void unittest_Bank_update_IRB_shortfall_mortgage_loans_2()
 * \brief: Unit test for: 
 * Status: PASS 26.10.17
 */
void unittest_Bank_update_IRB_shortfall_mortgage_loans_2()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
    EQUITY = 84.50;
    CAPITAL_ADJ_PL_MORTGAGE_LOANS = 0.0;
	CAPITAL_ADJ_NPL_MORTGAGE_LOANS = 0.0;

    HH_EL_PL_YEAR = 15.5;
    HH_EL_PL_REG  = 10.9;
	REA_MORTGAGE_LOANS  = 491.04;

	printf("\n\nFixture 2:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_MORTGAGE_LOANS = %.2f\n HH_EL_PL_YEAR = %.2f\n HH_EL_PL_REG = %.2f\n REA_MORTGAGE_LOANS = %.2f\n", 
    EQUITY,
    CAPITAL_ADJ_PL_MORTGAGE_LOANS,
    HH_EL_PL_YEAR,
    HH_EL_PL_REG,
	REA_MORTGAGE_LOANS);

    /***** Function evaluation ***************************************/
	Bank_update_IRB_shortfall_mortgage_loans();
    
    /***** Variables: Memory post-conditions *****/
    //	CU_ASSERT_DOUBLE_EQUAL(var, result, 1e-2);
    //	CU_ASSERT_EQUAL(var, result);
	printf("\n\nResult:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_MORTGAGE_LOANS = %.2f\n CAPITAL_ADJ_NPL_MORTGAGE_LOANS = %.2f", 
    EQUITY,
    CAPITAL_ADJ_PL_MORTGAGE_LOANS,
    CAPITAL_ADJ_PL_MORTGAGE_LOANS);

    CU_ASSERT_DOUBLE_EQUAL(EQUITY, 87.45, 1e-2);
    CU_ASSERT_DOUBLE_EQUAL(CAPITAL_ADJ_PL_MORTGAGE_LOANS, -2.95, 1e-2);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}


/*
 * \fn: void unittest_Bank_update_IRB_shortfall_mortgage_loans_3()
 * \brief: Unit test for: 
 * Status: 
 */
void unittest_Bank_update_IRB_shortfall_mortgage_loans_3()
{
    /************* At start of unit test, add one agent **************/
	unittest_init_Bank_agent();
	
    /***** Variables: Memory pre-conditions **************************/
    EQUITY = 92.70;
    CAPITAL_ADJ_PL_MORTGAGE_LOANS = 4.80;
	CAPITAL_ADJ_NPL_MORTGAGE_LOANS = 0.0;

    HH_EL_PL_YEAR = 15.5;
    HH_EL_PL_REG  = 10.9;
	REA_MORTGAGE_LOANS  = 491.04;

	printf("\n\nFixture 2:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_MORTGAGE_LOANS = %.2f\n HH_EL_PL_YEAR = %.2f\n HH_EL_PL_REG = %.2f\n REA_MORTGAGE_LOANS = %.2f\n", 
    EQUITY,
    CAPITAL_ADJ_PL_MORTGAGE_LOANS,
    HH_EL_PL_YEAR,
    HH_EL_PL_REG,
	REA_MORTGAGE_LOANS);

    /***** Function evaluation ***************************************/
	Bank_update_IRB_shortfall_mortgage_loans();
    
    /***** Variables: Memory post-conditions *****/

	printf("\n\nResult:\n EQUITY = %.2f\n CAPITAL_ADJ_PL_MORTGAGE_LOANS = %.2f\n CAPITAL_ADJ_NPL_MORTGAGE_LOANS = %.2f", 
    EQUITY,
    CAPITAL_ADJ_PL_MORTGAGE_LOANS,
    CAPITAL_ADJ_PL_MORTGAGE_LOANS);

    CU_ASSERT_DOUBLE_EQUAL(EQUITY, 87.45, 1e-2);
    CU_ASSERT_DOUBLE_EQUAL(CAPITAL_ADJ_PL_MORTGAGE_LOANS, -2.95, 1e-2);

    /************* At end of unit test, free the agent **************/
	unittest_free_Bank_agent();

    /************* At end of unit tests, free all Messages **********/
    free_messages();
}
